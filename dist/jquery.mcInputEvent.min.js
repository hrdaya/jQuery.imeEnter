/*!
 * jQuery.mcInputEvent v0.3.0 (http://hrdaya.github.io/jQuery.mcInputEvent/)
 *
 * Copyright 2015 yu-ki higa (https://github.com/hrdaya)
 * Licensed under MIT (https://github.com/hrdaya/jQuery.mcInputEvent/blob/master/LICENSE)
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";var b="mcInputEvent",c="mcinput",d="input2",e=!1,f=!1,g=window.navigator.userAgent.toLowerCase();(g.indexOf("msie")>-1||g.indexOf("trident")>-1||g.indexOf("edge")>-1)&&(e=!0,g.indexOf("msie 9.0")>-1&&(f=!0));var h=function(c){this.$elm=a(c),this.isComposition=!1,this.timer,this.obj={lastVal:"",tagType:"html"},this.checkEvents=["input."+b,"compositionstart."+b,"compositionend."+b],this.init()};h.prototype={on:function(){this.off(),this.$elm.on(this.checkEvents.join(" "),this.setEvents.bind(this))},off:function(){this.$elm.off("."+b),a(document).off("."+b)},destroy:function(){this.off(),this.$elm.removeData(b)},triggerEvent:function(){this.$elm.trigger("input")},init:function(){var a=this.$elm.prop("tagName").toLowerCase();"input"===a||"textarea"===a?(this.obj.tagType="input",f&&(this.checkEvents.push("focus."+b),this.checkEvents.push("blur."+b))):e&&(this.checkEvents.push("focus."+b),this.checkEvents.push("blur."+b)),e&&(this.checkEvents.push("keyup."+b),this.checkEvents.push("drop."+b)),this.setLastVal()},setEvents:function(c){switch(c.type){case"input":this.setLastVal(),this.triggerInput2(),this.isComposition||this.triggerMcInput();break;case"compositionstart":this.isComposition=!0;break;case"compositionend":this.isComposition=!1,e&&this.triggerEvent();break;case"focus":a(document).on("selectionchange."+b,this.triggerInput.bind(this));break;case"blur":a(document).off("selectionchange."+b),this.setDelayInputEvent();break;case"keyup":this.triggerInput();break;case"drop":this.setDelayInputEvent()}},triggerMcInput:function(){this.$elm.trigger(a.Event(c,this.obj))},triggerInput2:function(){this.$elm.trigger(a.Event(d,this.obj))},triggerInput:function(){this.isSameVal()||this.$elm.trigger("input")},setDelayInputEvent:function(){clearTimeout(this.timer),this.timer=setTimeout(this.triggerInput.bind(this),50)},isSameVal:function(){return"input"===this.obj.tagType?this.obj.lastVal===this.$elm.val():this.obj.lastVal===this.$elm.html()},setLastVal:function(){this.obj.lastVal="input"===this.obj.tagType?this.$elm.val():this.$elm.html()}},a.fn[b]=function(c){return window.hasOwnProperty("CompositionEvent")&&(c=c||"on",this.each(function(){var d=a.data(this,b)||a.data(this,b,new h(this));switch(c){case"on":case"off":case"destroy":case"triggerEvent":d[c]()}})),this}});